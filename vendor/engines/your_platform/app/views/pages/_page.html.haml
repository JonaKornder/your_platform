%h1
  - if can? :update, page
    - if page.title.blank?
      = best_in_place(page, :title, display_as: :title, nil: "—")
    - else
      = best_in_place(page, :title, display_as: :title, nil: "…")
  - else
    = page.title
%div.page
  %div.page_header
    - if page.author
      %span.page_author
        = link_to(page.author.title, page.author) + ", "
    %span.page_created_at
      = localize(page.created_at) if page.created_at
    - if page.updated_at && page.updated_at > page.created_at + 1.hour
      %span.page_updated_at
        = " | "       
        = t(:edited_at)
        = localize(page.updated_at)
  %div.page_body
    %div{ id: 'page_content', data: { mercury: 'full' } }
      - if can? :update, page
        - if page.content.blank?
          = best_in_place page, :content, type: 'textarea', sanitize: false, display_with: :markup, nil: "—"
        - else
          = best_in_place page, :content, type: 'textarea', sanitize: false, display_with: :markup, nil: "…"
      - else
        = markup(page.content)

= render(partial: 'pages/pictures', locals: {page: page}) 
= render(partial: 'pages/videos', locals: {page: page}) 
= render(partial: 'pages/attachments', locals: {page: page})



