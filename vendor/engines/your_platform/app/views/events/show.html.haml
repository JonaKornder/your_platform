%h1= best_in_place_if can?(:update, @event), @event, :name
%div
  %span.ics_export_buttons
    %a.btn#ics_export.has_tooltip{href: event_path(format: 'ics'), title: 'Dieses Ereignis als ICS-Datei (iCal) herunterladen, um es in einer Kalender-Anwendung zu öffnen.', data: {placement: 'top'}}
      %i.icon-calendar
      Kalender-Export
  = render partial: 'events/event_details'
        
%h1=t :attendees
%div
  %div#attendees_avatars
    = render partial: 'groups/member_avatars', locals: {group: @event.attendees_group}
  
  - if can? :join, @event
    %p.center.join_event
      - if @event.attendees.include? current_user
        - join_button_hidden_class = 'hidden'
      - else
        - leave_button_hidden_class = 'hidden'
      %a.btn.btn-success#join_event{href: event_join_path(@event, format: 'json'), class: join_button_hidden_class}
        %i.icon-user
        An dieser Veranstaltung teilnehmen
      - if can? :leave, @event
        %a.btn.btn-danger#leave_event{href: event_leave_path(@event, format: 'json'), class: leave_button_hidden_class}
          %i.icon-user
          Doch nicht teilnehmen
  
  - if can? :update, @event
    %p.center.invitation
      %a.btn.has_tooltip#toggle_invite{href: '#', title: 'Auf diesen Knopf drücken, dann den Nachrichtentext überprüfen und bestätigen.', data: {placement: 'right'}}
        %i.icon-envelope
        = "Alle Mitglieder der Gruppe '#{@event.group.name}' per E-Mail einladen …"
      %form.hidden#invite
        %textarea#invitation_text= render partial: 'events/invitation_text'
        %div.right
          %a.btn#test_invite{href: event_invite_path(event_id: @event.id, recipient: 'me', format: 'json')}
            %i.icon-envelope
            = "Zum Testen an meine eigene Adresse senden."
          %a.btn.btn-primary#confirm_invite{href: event_invite_path(event_id: @event.id, recipient: @event.group.id, format: 'json')}
            %i.icon-envelope
            = "An '#{@event.group.name}' senden."